# Cargar y/o instalar librerias
library(igraph)
library(readxl)
Matriz_de_Adyacencia_Limpia <- read_excel("Matriz de Adyacencia Limpia.xlsx",
range = "B1:Q17")
View(Matriz_de_Adyacencia_Limpia)
library(readxl)
m.adj <- read_excel("Matriz de Adyacencia Limpia.xlsx",
range = "B1:Q17")
m.adj.m <- as.matrix(m.adj)
View(m.adj.m)
View(m.adj.m)
View(m.adj)
View(m.adj.m)
class(m.adj)
class(m.adj,m)
class(m.adj.m)
m.adj <- as.matrix(read_excel("Matriz de Adyacencia Limpia.xlsx",
range = "B1:Q17"))
head(m.adj)
rownames(m.adj)
names(m.adj)
View(m.adj)
# crear grafo desde la matriz de adyacencia
graph.adj <- igraph::graph_from_adjacency_matrix(m.adj)
# crear grafo desde la matriz de adyacencia
graph.adj <- igraph::graph_from_adjacency_matrix(m.adj, mode = "directed")
m.adj <- matrix(read_excel("Matriz de Adyacencia Limpia.xlsx",
range = "B1:Q17"))
head(m.adj)
m.adj <- as.matrix(read_excel("Matriz de Adyacencia Limpia.xlsx",
range = "B1:Q17"))
head(m.adj)
m.adj
# crear grafo desde la matriz de adyacencia
graph.adj <- igraph::graph_from_adjacency_matrix(m.adj,
weighted = NULL,
mode = "directed")
m.adj<-matrix(sample(16^2,x= c(-1,0,1), replace=TRUE))
# crear grafo desde la matriz de adyacencia
graph.adj <- igraph::graph_from_adjacency_matrix(m.adj,
weighted = NULL,
mode = "directed")
m.adj
m.adj<-matrix(sample(16^2,x= c(-1,0,1), replace=TRUE), nrow = 16)
# crear grafo desde la matriz de adyacencia
graph.adj <- igraph::graph_from_adjacency_matrix(m.adj,
weighted = NULL,
mode = "directed")
abs(m.adj)
w.m.adj <- abs(m.adj)
# crear grafo desde la matriz de adyacencia
graph.adj <- igraph::graph_from_adjacency_matrix(w.m.adj,
weighted = m.adj,
mode = "directed")
# Calcular las variables de centralidad de cada variable
centralidad_grado <- degree(graph.adj)
cercania_centralidad <- closeness(g)
cercania_centralidad <- closeness(graph.adj)
plot(graph.adj)
# crear grafo desde la matriz de adyacencia
graph.adj <- igraph::graph_from_adjacency_matrix(w.m.adj,
weighted = NULL,
mode = "directed")
plot(graph.adj)
w.m.adj
m.adj
m.adj <- as.matrix(read_excel("Matriz de Adyacencia Limpia.xlsx",
range = "B1:Q17"))
w.m.adj <- abs(m.adj)
# crear grafo desde la matriz de adyacencia
graph.adj <- igraph::graph_from_adjacency_matrix(w.m.adj,
weighted = NULL,
mode = "directed")
plot(graph.adj)
# crear grafo desde la matriz de adyacencia
graph.adj <- igraph::graph_from_adjacency_matrix(w.m.adj,
weighted = m.adj,
mode = "directed")
plot(graph.adj)
# Asignar nombres a los nodos (variables)
V(graph.adj)$name <- paste("V", 1:vcount(grafo), sep = "")
# Asignar nombres a los nodos (variables)
V(graph.adj)$name <- paste("V", 1:vcount(graph.adj), sep = "")
# Configurar el color de las aristas
# Si el peso es positivo (1), la arista es azul.
# Si el peso es negativo (-1), la arista es roja.
colores_aristas <- ifelse(E(graph.adj)$weight > 0, "blue", "red")
# Configurar el ancho de las aristas
# Las aristas con peso negativo pueden ser más delgadas o punteadas para mayor diferenciación
anchos_aristas <- abs(E(graph.adj)$weight) * 2  # Multiplicamos por 2 para que sean visibles
# Opciones de diseño del grafo
layout_grafo <- layout_with_fr(graph.adj)
# Plotear el grafo con las opciones personalizadas
plot(graph.adj,
vertex.color = "lightgreen",        # Color de los nodos
vertex.size = 15,                   # Tamaño de los nodos
vertex.label.color = "black",       # Color de las etiquetas de los nodos
vertex.label.cex = 0.8,             # Tamaño de la fuente de las etiquetas
edge.color = colores_aristas,       # Colores de las aristas definidos anteriormente
# edge.width = anchos_aristas,        # Ancho de las aristas
edge.arrow.size = 0.5,              # Tamaño de las puntas de flecha
edge.curved = 0.2,                  # Curvatura de las aristas para evitar superposición
layout = layout_grafo               # El diseño del grafo
)
# Plotear el grafo con las opciones personalizadas
plot(graph.adj,
vertex.color = "lightgreen",        # Color de los nodos
vertex.size = 15,                   # Tamaño de los nodos
vertex.label.color = "black",       # Color de las etiquetas de los nodos
vertex.label.cex = 0.8,             # Tamaño de la fuente de las etiquetas
edge.color = colores_aristas,       # Colores de las aristas definidos anteriormente
edge.width = 1,#anchos_aristas,        # Ancho de las aristas
edge.arrow.size = 0.5,              # Tamaño de las puntas de flecha
edge.curved = 0.2,                  # Curvatura de las aristas para evitar superposición
layout = layout_grafo               # El diseño del grafo
)
# Agregar una leyenda para los colores de las aristas
legend("topright",
legend = c("Relación Positiva (+1)", "Relación Negativa (-1)"),
col = c("blue", "red"),
lwd = 2,
title = "Tipo de Relación")
# Configurar el ancho de las aristas
# Las aristas con peso negativo pueden ser más delgadas o punteadas para mayor diferenciación
anchos_aristas <- abs(E(graph.adj)$weight) * 2  # Multiplicamos por 2 para que sean visibles
graph.adj
E(graph.adj)
E(graph.adj)$weight
E(graph.adj)
E(graph.adj)
aaa <- E(graph.adj)
# Configurar el ancho de las aristas
# Las aristas con peso negativo pueden ser más delgadas o punteadas para mayor diferenciación
anchos_aristas <- abs(E(graph.adj)$weight)>0# * 2  # Multiplicamos por 2 para que sean visibles
# Configurar el ancho de las aristas
# Las aristas con peso negativo pueden ser más delgadas o punteadas para mayor diferenciación
anchos_aristas <- ifelse(E(graph.adj)$weight!=0,2,0)# * 2  # Multiplicamos por 2 para que sean visibles
# Opciones de diseño del grafo
layout_grafo <- layout_with_fr(graph.adj)
# Plotear el grafo con las opciones personalizadas
plot(graph.adj,
vertex.color = "lightgreen",        # Color de los nodos
vertex.size = 15,                   # Tamaño de los nodos
vertex.label.color = "black",       # Color de las etiquetas de los nodos
vertex.label.cex = 0.8,             # Tamaño de la fuente de las etiquetas
edge.color = colores_aristas,       # Colores de las aristas definidos anteriormente
edge.width = 1,#anchos_aristas,        # Ancho de las aristas
edge.arrow.size = 0.5,              # Tamaño de las puntas de flecha
edge.curved = 0.2,                  # Curvatura de las aristas para evitar superposición
layout = layout_grafo               # El diseño del grafo
)
# Agregar una leyenda para los colores de las aristas
legend("topright",
legend = c("Relación Positiva (+1)", "Relación Negativa (-1)"),
col = c("blue", "red"),
lwd = 2,
title = "Tipo de Relación")
# Plotear el grafo con las opciones personalizadas
plot(graph.adj,
vertex.color = "lightgreen",        # Color de los nodos
vertex.size = 15,                   # Tamaño de los nodos
vertex.label.color = "black",       # Color de las etiquetas de los nodos
vertex.label.cex = 0.8,             # Tamaño de la fuente de las etiquetas
edge.color = colores_aristas,       # Colores de las aristas definidos anteriormente
edge.width = anchos_aristas,        # Ancho de las aristas
edge.arrow.size = 0.5,              # Tamaño de las puntas de flecha
edge.curved = 0.2,                  # Curvatura de las aristas para evitar superposición
layout = layout_grafo               # El diseño del grafo
)
# Agregar una leyenda para los colores de las aristas
legend("topright",
legend = c("Relación Positiva (+1)", "Relación Negativa (-1)"),
col = c("blue", "red"),
lwd = 2,
title = "Tipo de Relación")
anchos_aristas
ifelse(E(graph.adj)$weight!=0,2,0)
E(graph.adj)$weight
graph.adj
E(graph.adj)
# crear grafo desde la matriz de adyacencia
graph.adj <- igraph::graph_from_adjacency_matrix(w.m.adj,
weighted = TRUE,
mode = "directed")
E(graph.adj)
# Asignar nombres a los nodos (variables)
V(graph.adj)$name <- paste("V", 1:vcount(graph.adj), sep = "")
# Configurar el color de las aristas
# Si el peso es positivo (1), la arista es azul.
# Si el peso es negativo (-1), la arista es roja.
colores_aristas <- ifelse(E(graph.adj)$weight > 0, "blue", "red")
# Configurar el ancho de las aristas
# Las aristas con peso negativo pueden ser más delgadas o punteadas para mayor diferenciación
anchos_aristas <- ifelse(E(graph.adj)$weight!=0,2,0)# * 2  # Multiplicamos por 2 para que sean visibles
# Opciones de diseño del grafo
layout_grafo <- layout_with_fr(graph.adj)
# Plotear el grafo con las opciones personalizadas
plot(graph.adj,
vertex.color = "lightgreen",        # Color de los nodos
vertex.size = 15,                   # Tamaño de los nodos
vertex.label.color = "black",       # Color de las etiquetas de los nodos
vertex.label.cex = 0.8,             # Tamaño de la fuente de las etiquetas
edge.color = colores_aristas,       # Colores de las aristas definidos anteriormente
edge.width = anchos_aristas,        # Ancho de las aristas
edge.arrow.size = 0.5,              # Tamaño de las puntas de flecha
edge.curved = 0.2,                  # Curvatura de las aristas para evitar superposición
layout = layout_grafo               # El diseño del grafo
)
# Agregar una leyenda para los colores de las aristas
legend("topright",
legend = c("Relación Positiva (+1)", "Relación Negativa (-1)"),
col = c("blue", "red"),
lwd = 2,
title = "Tipo de Relación")
# crear grafo desde la matriz de adyacencia
graph.adj <- igraph::graph_from_adjacency_matrix(m.adj,
weighted = TRUE,
mode = "directed")
E(graph.adj)
# Asignar nombres a los nodos (variables)
V(graph.adj)$name <- paste("V", 1:vcount(graph.adj), sep = "")
# Configurar el color de las aristas
# Si el peso es positivo (1), la arista es azul.
# Si el peso es negativo (-1), la arista es roja.
colores_aristas <- ifelse(E(graph.adj)$weight > 0, "blue", "red")
# Configurar el ancho de las aristas
# Las aristas con peso negativo pueden ser más delgadas o punteadas para mayor diferenciación
anchos_aristas <- ifelse(E(graph.adj)$weight!=0,2,0)# * 2  # Multiplicamos por 2 para que sean visibles
# Opciones de diseño del grafo
layout_grafo <- layout_with_fr(graph.adj)
# Plotear el grafo con las opciones personalizadas
plot(graph.adj,
vertex.color = "lightgreen",        # Color de los nodos
vertex.size = 15,                   # Tamaño de los nodos
vertex.label.color = "black",       # Color de las etiquetas de los nodos
vertex.label.cex = 0.8,             # Tamaño de la fuente de las etiquetas
edge.color = colores_aristas,       # Colores de las aristas definidos anteriormente
edge.width = anchos_aristas,        # Ancho de las aristas
edge.arrow.size = 0.5,              # Tamaño de las puntas de flecha
edge.curved = 0.2,                  # Curvatura de las aristas para evitar superposición
layout = layout_grafo               # El diseño del grafo
)
# Agregar una leyenda para los colores de las aristas
legend("topright",
legend = c("Relación Positiva (+1)", "Relación Negativa (-1)"),
col = c("blue", "red"),
lwd = 2,
title = "Tipo de Relación")
## Calcular las variables de centralidad de cada variable ----
centralidad_grado <- degree(graph.adj)
centralidad_grado
cercania_centralidad <- closeness(graph.adj)
# Plotear el grafo con las opciones personalizadas
plot(graph.adj,
vertex.color = "lightgreen",        # Color de los nodos
vertex.size = 20,                   # Tamaño de los nodos
vertex.label.color = "black",       # Color de las etiquetas de los nodos
vertex.label.cex = 0.8,             # Tamaño de la fuente de las etiquetas
edge.color = colores_aristas,       # Colores de las aristas definidos anteriormente
edge.width = anchos_aristas,        # Ancho de las aristas
edge.arrow.size = 0.5,              # Tamaño de las puntas de flecha
edge.curved = 0.2,                  # Curvatura de las aristas para evitar superposición
layout = layout_grafo               # El diseño del grafo
)
# Plotear el grafo con las opciones personalizadas
plot(graph.adj,
vertex.color = "lightgreen",        # Color de los nodos
vertex.size = 20,                   # Tamaño de los nodos
vertex.label.color = "black",       # Color de las etiquetas de los nodos
vertex.label.cex = 0.5,             # Tamaño de la fuente de las etiquetas
edge.color = colores_aristas,       # Colores de las aristas definidos anteriormente
edge.width = anchos_aristas,        # Ancho de las aristas
edge.arrow.size = 0.5,              # Tamaño de las puntas de flecha
edge.curved = 0.2,                  # Curvatura de las aristas para evitar superposición
layout = layout_grafo               # El diseño del grafo
)
# Plotear el grafo con las opciones personalizadas
plot(graph.adj,
vertex.color = "lightgreen",        # Color de los nodos
vertex.size = 20,                   # Tamaño de los nodos
vertex.label.color = "black",       # Color de las etiquetas de los nodos
vertex.label.cex = 0.8,             # Tamaño de la fuente de las etiquetas
edge.color = colores_aristas,       # Colores de las aristas definidos anteriormente
edge.width = anchos_aristas,        # Ancho de las aristas
edge.arrow.size = 0.5,              # Tamaño de las puntas de flecha
edge.curved = 0.2,                  # Curvatura de las aristas para evitar superposición
layout = layout_grafo               # El diseño del grafo
)
graph.abs<- igraph::graph_from_adjacency_matrix(w.m.adj,
weighted = TRUE,
mode = "directed")
## Calcular las variables de centralidad de cada variable ----
centralidad_grado <- degree(graph.adj.a)
## Calcular las variables de centralidad de cada variable ----
centralidad_grado <- degree(graph.abs)
cercania_centralidad <- closeness(graph.abs)
centralidad_grado
cercania_centralidad
intermediacion_centralidad <- betweenness(graph.abs)
intermediacion_centralidad
centralidad_propia <- eigen(graph.abs)$vectors[,1]
centralidad_propia <- eigen(m.adj.m)$vectors[,1]
centralidad_propia
V(graph.abs)$grado <- grado_centralidad
V(graph.abs)$grado <- centralidad_grado
V(graph.abs)$cercania <- cercania_centralidad
V(graph.abs)$intermediacion <- intermediacion_centralidad
V(graph.abs)$centralidad_propia <- centralidad_propia
plot(graph.abs, vertex.size = V(graph.abs)$grado * 5, vertex.label = 1:vcount(graph.abs))
plot(graph.abs, vertex.size = V(graph.abs)$cercania * 5, vertex.label = 1:vcount(graph.abs))
plot(graph.abs, vertex.size = V(graph.abs)$intermediacion * 5, vertex.label = 1:vcount(graph.abs))
plot(graph.abs, vertex.size = V(graph.abs)$intermediacion * 1, vertex.label = 1:vcount(graph.abs))
plot(graph.abs, vertex.size = V(graph.abs)$intermediacion * 2, vertex.label = 1:vcount(graph.abs))
plot(graph.abs, vertex.size = V(graph.abs)$centralidad_propia * 2, vertex.label = 1:vcount(graph.abs))
plot(graph.abs, vertex.size = V(graph.abs)$centralidad_propia, vertex.label = 1:vcount(graph.abs))
plot(graph.abs, vertex.size = V(graph.abs)$cercania * 5, vertex.label = 1:vcount(graph.abs))
closeness(graph.abs)
cercania_centralidad <- closeness(graph.adj)
cercania_centralidad <- closeness(graph.abs)
graph.abs
cercania_centralidad <- closeness(graph.abs)
m.adj <- t(as.matrix(read_excel("Matriz de Adyacencia Limpia.xlsx",
range = "B1:Q17")))
m.adj
w.m.adj <- abs(m.adj)
# crear grafo desde la matriz de adyacencia
graph.adj <- igraph::graph_from_adjacency_matrix(m.adj,
weighted = TRUE,
mode = "directed")
graph.abs<- igraph::graph_from_adjacency_matrix(w.m.adj,
weighted = TRUE,
mode = "directed")
E(graph.adj)
# Asignar nombres a los nodos (variables)
V(graph.adj)$name <- paste("V", 1:vcount(graph.adj), sep = "")
# Configurar el color de las aristas
# Si el peso es positivo (1), la arista es azul.
# Si el peso es negativo (-1), la arista es roja.
colores_aristas <- ifelse(E(graph.adj)$weight > 0, "blue", "red")
# Configurar el ancho de las aristas
# Las aristas con peso negativo pueden ser más delgadas o punteadas para mayor diferenciación
anchos_aristas <- ifelse(E(graph.adj)$weight!=0,2,0)# * 2  # Multiplicamos por 2 para que sean visibles
# Opciones de diseño del grafo
layout_grafo <- layout_with_fr(graph.adj)
# Opciones de diseño del grafo
layout_grafo <- layout_with_fr(graph.abs)
# Plotear el grafo con las opciones personalizadas
plot(graph.adj,
vertex.color = "lightgreen",        # Color de los nodos
vertex.size = 20,                   # Tamaño de los nodos
vertex.label.color = "black",       # Color de las etiquetas de los nodos
vertex.label.cex = 0.8,             # Tamaño de la fuente de las etiquetas
edge.color = colores_aristas,       # Colores de las aristas definidos anteriormente
edge.width = anchos_aristas,        # Ancho de las aristas
edge.arrow.size = 0.5,              # Tamaño de las puntas de flecha
edge.curved = 0.2,                  # Curvatura de las aristas para evitar superposición
layout = layout_grafo               # El diseño del grafo
)
# Agregar una leyenda para los colores de las aristas
legend("topright",
legend = c("Relación Positiva (+1)", "Relación Negativa (-1)"),
col = c("blue", "red"),
lwd = 2,
title = "Tipo de Relación")
## Calcular las variables de centralidad de cada variable ----
centralidad_grado <- degree(graph.abs)
cercania_centralidad <- closeness(graph.abs)
intermediacion_centralidad <- betweenness(graph.abs)
centralidad_propia <- eigen(m.adj.m)$vectors[,1]
V(graph.abs)$grado <- centralidad_grado
V(graph.abs)$cercania <- cercania_centralidad
V(graph.abs)$intermediacion <- intermediacion_centralidad
V(graph.abs)$centralidad_propia <- centralidad_propia
plot(graph.abs, vertex.size = V(graph.abs)$grado * 5, vertex.label = 1:vcount(graph.abs))
plot(graph.abs, vertex.size = V(graph.abs)$cercania * 5, vertex.label = 1:vcount(graph.abs))
plot(graph.abs, vertex.size = V(graph.abs)$intermediacion * 2, vertex.label = 1:vcount(graph.abs))
plot(graph.abs, vertex.size = V(graph.abs)$centralidad_propia, vertex.label = 1:vcount(graph.abs))
centralidad_propia
plot(graph.abs, vertex.size = V(graph.abs)$centralidad_propia, vertex.label = 1:vcount(graph.abs))
V(graph.abs)$centralidad_propia
centralidad_propia <- eigen(adj.m)$vectors[,1]
centralidad_propia <- eigen(m.adj)$vectors[,1]
V(graph.abs)$grado <- centralidad_grado
V(graph.abs)$cercania <- cercania_centralidad
V(graph.abs)$intermediacion <- intermediacion_centralidad
V(graph.abs)$centralidad_propia <- centralidad_propia
plot(graph.abs, vertex.size = V(graph.abs)$grado * 5, vertex.label = 1:vcount(graph.abs))
plot(graph.abs, vertex.size = V(graph.abs)$cercania * 5, vertex.label = 1:vcount(graph.abs))
plot(graph.abs, vertex.size = V(graph.abs)$intermediacion * 2, vertex.label = 1:vcount(graph.abs))
plot(graph.abs, vertex.size = V(graph.abs)$centralidad_propia, vertex.label = 1:vcount(graph.abs))
centralidad_propia
eigen(m.adj)$vectors
eigen(m.adj)
centralidad_propia <- eigen(m.adj)$values
V(graph.abs)$grado <- centralidad_grado
V(graph.abs)$cercania <- cercania_centralidad
V(graph.abs)$intermediacion <- intermediacion_centralidad
V(graph.abs)$centralidad_propia <- centralidad_propia
plot(graph.abs, vertex.size = V(graph.abs)$grado * 5, vertex.label = 1:vcount(graph.abs))
plot(graph.abs, vertex.size = V(graph.abs)$cercania * 5, vertex.label = 1:vcount(graph.abs))
plot(graph.abs, vertex.size = V(graph.abs)$intermediacion * 2, vertex.label = 1:vcount(graph.abs))
plot(graph.abs, vertex.size = V(graph.abs)$centralidad_propia, vertex.label = 1:vcount(graph.abs))
